<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Harpnotes::Layout::Default
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Harpnotes.html" title="Harpnotes (module)">Harpnotes</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Layout.html" title="Harpnotes::Layout (module)">Layout</a></span></span>
     &raquo; 
    <span class="title">Default</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Harpnotes::Layout::Default
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Harpnotes::Layout::Default</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">harpnotes.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>the default layout engine representing vanilla table harp sheets This might
be the only one at all ...</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="ELLIPSE_SIZE-constant" class="">ELLIPSE_SIZE =
          <div class="docstring">
  <div class="discussion">
    
<p>all numbers in mm</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span> <span class='float'>2.8</span><span class='comma'>,</span> <span class='float'>1.7</span> <span class='rbracket'>]</span></pre></dd>
      
        <dt id="X_SPACING-constant" class="">X_SPACING =
          <div class="docstring">
  <div class="discussion">
    
<p>x-size of one step in a pitch. It is the horizontal distance between two
strings of the harp</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>115</span> <span class='op'>/</span> <span class='int'>10</span></pre></dd>
      
        <dt id="BEAT_SPACING-constant" class="">BEAT_SPACING =
          <div class="docstring">
  <div class="discussion">
    
<p>Spacing between beats</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>4</span> <span class='op'>*</span> <span class='float'>1.0</span><span class='op'>/</span><span class='float'>64.0</span> <span class='op'>*</span> <span class='int'>1</span></pre></dd>
      
        <dt id="Y_OFFSET-constant" class="">Y_OFFSET =
          <div class="docstring">
  <div class="discussion">
    
<p>Y coordinate of the very first beat</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='int'>5</span></pre></dd>
      
        <dt id="X_OFFSET-constant" class="">X_OFFSET =
          
        </dt>
        <dd><pre class="code"><span class='const'>ELLIPSE_SIZE</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span></pre></dd>
      
        <dt id="PITCH_OFFSET-constant" class="">PITCH_OFFSET =
          <div class="docstring">
  <div class="discussion">
    
<p>this is the negative of midi-pitch of the lowest playble note see <a
href="http://computermusicresource.com/midikeys.html">computermusicresource.com/midikeys.html</a></p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='op'>-</span><span class='int'>43</span></pre></dd>
      
        <dt id="DURATION_TO_STYLE-constant" class="">DURATION_TO_STYLE =
          <div class="docstring">
  <div class="discussion">
    
<p>This is a lookup table to map durations to graphical representation</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='comment'>#key      size   fill          dot                  abc duration
</span>  <span class='symbol'>:d64</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.9</span><span class='comma'>,</span>   <span class='symbol'>:empty</span><span class='comma'>,</span>       <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1      1
</span>  <span class='symbol'>:d48</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.7</span><span class='comma'>,</span>   <span class='symbol'>:empty</span><span class='comma'>,</span>       <span class='const'>TRUE</span><span class='rbracket'>]</span><span class='comma'>,</span>     <span class='comment'># 1/2 *
</span>  <span class='symbol'>:d32</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.7</span><span class='comma'>,</span>   <span class='symbol'>:empty</span><span class='comma'>,</span>       <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/2
</span>  <span class='symbol'>:d24</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.7</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>TRUE</span><span class='rbracket'>]</span><span class='comma'>,</span>     <span class='comment'># 1/4 *
</span>  <span class='symbol'>:d16</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.7</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/4
</span>  <span class='symbol'>:d12</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.5</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>TRUE</span><span class='rbracket'>]</span><span class='comma'>,</span>     <span class='comment'># 1/8 *
</span>  <span class='symbol'>:d8</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.5</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/8
</span>  <span class='symbol'>:d6</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.3</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>TRUE</span><span class='rbracket'>]</span><span class='comma'>,</span>     <span class='comment'># 1/16 *
</span>  <span class='symbol'>:d4</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.3</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/16
</span>  <span class='symbol'>:d3</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.1</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>TRUE</span><span class='rbracket'>]</span><span class='comma'>,</span>     <span class='comment'># 1/32 *
</span>  <span class='symbol'>:d2</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.1</span><span class='comma'>,</span>   <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/32
</span>  <span class='symbol'>:d1</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='float'>0.05</span><span class='comma'>,</span>  <span class='symbol'>:filled</span><span class='comma'>,</span>      <span class='const'>FALSE</span><span class='rbracket'>]</span><span class='comma'>,</span>    <span class='comment'># 1/64
</span><span class='rbrace'>}</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#compute_beat_compression-instance_method" title="#compute_beat_compression (instance method)">- (Hash) <strong>compute_beat_compression</strong>(music) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>compress  beat layout of a music sheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compute_beat_layout-instance_method" title="#compute_beat_layout (instance method)">- (Lambda) <strong>compute_beat_layout</strong>(music) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the vertical layout policy.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#duration_to_id-instance_method" title="#duration_to_id (instance method)">- (Object) <strong>duration_to_id</strong>(duration) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert a duration to a symbol todo: move DURATION_TO_STYLE in here.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#layout-instance_method" title="#layout (instance method)">- (Harpnotes::Drawing::Sheet) <strong>layout</strong>(music, beat_layout = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>compute the layout of the Harnote sheet.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#layout_accord-instance_method" title="#layout_accord (instance method)">- (Object) <strong>layout_accord</strong>(root, beat_layout) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Place a SynchPoint on the Sheet.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#layout_measure_start-instance_method" title="#layout_measure_start (instance method)">- (Object) <strong>layout_measure_start</strong>(root, beat_layout) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#layout_note-instance_method" title="#layout_note (instance method)">- (Object) <strong>layout_note</strong>(root, beat_layout) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Place a Note on the sheet.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#layout_pause-instance_method" title="#layout_pause (instance method)">- (Object) <strong>layout_pause</strong>(root, beat_layout) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Draw a Pause on the Sheet.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#layout_playables-instance_method" title="#layout_playables (instance method)">- (type) <strong>layout_playables</strong>(root, beat_layout) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>layout the one Playable on the sheet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#layout_voice-instance_method" title="#layout_voice (instance method)">- (Array of Element) <strong>layout_voice</strong>(voice, beat_layout, show_flowline = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>compute the layout of a particular voice.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="compute_beat_compression-instance_method">
  
    - (<tt>Hash</tt>) <strong>compute_beat_compression</strong>(music)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>compress  beat layout of a music sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>music</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Harpnotes::Music::Document the document to optimize the beat layout</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a beat map =&gt; 5 beat 10 is placed at vertical position 5</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 756</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compute_beat_compression'>compute_beat_compression</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_max_beat'>max_beat</span> <span class='op'>=</span> <span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_beat_maps'>beat_maps</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_map'>map</span><span class='op'>|</span> <span class='id identifier rubyid_map'>map</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>

  <span class='id identifier rubyid_current_beat'>current_beat</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_last_size'>last_size</span> <span class='op'>=</span> <span class='int'>32</span>
  <span class='const'>Hash</span><span class='lbracket'>[</span><span class='lparen'>(</span><span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_max_beat'>max_beat</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_beat'>beat</span><span class='op'>|</span>
         <span class='id identifier rubyid_notes_on_beat'>notes_on_beat</span> <span class='op'>=</span> <span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_beat_maps'>beat_maps</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bm'>bm</span><span class='op'>|</span> <span class='id identifier rubyid_bm'>bm</span><span class='lbracket'>[</span><span class='id identifier rubyid_beat'>beat</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
         <span class='id identifier rubyid_max_duration'>max_duration</span> <span class='op'>=</span> <span class='id identifier rubyid_notes_on_beat'>notes_on_beat</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span> <span class='id identifier rubyid_n'>n</span><span class='period'>.</span><span class='id identifier rubyid_duration'>duration</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
         <span class='id identifier rubyid_has_no_notes_on_beat'>has_no_notes_on_beat</span> <span class='op'>=</span> <span class='id identifier rubyid_notes_on_beat'>notes_on_beat</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

         <span class='kw'>unless</span> <span class='id identifier rubyid_has_no_notes_on_beat'>has_no_notes_on_beat</span>
           <span class='id identifier rubyid_size'>size</span> <span class='op'>=</span> <span class='int'>32</span> <span class='op'>*</span> <span class='const'>DURATION_TO_STYLE</span><span class='lbracket'>[</span><span class='id identifier rubyid_duration_to_id'>duration_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_max_duration'>max_duration</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
           <span class='id identifier rubyid_increment'>increment</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_size'>size</span> <span class='op'>+</span> <span class='id identifier rubyid_last_size'>last_size</span><span class='rparen'>)</span>
           <span class='id identifier rubyid_last_size'>last_size</span> <span class='op'>=</span> <span class='id identifier rubyid_size'>size</span>

           <span class='id identifier rubyid_current_beat'>current_beat</span> <span class='op'>+=</span> <span class='id identifier rubyid_increment'>increment</span> <span class='kw'>unless</span> <span class='id identifier rubyid_has_no_notes_on_beat'>has_no_notes_on_beat</span>
         <span class='kw'>end</span>
         <span class='lbracket'>[</span> <span class='id identifier rubyid_beat'>beat</span><span class='comma'>,</span> <span class='id identifier rubyid_current_beat'>current_beat</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="compute_beat_layout-instance_method">
  
    - (<tt>Lambda</tt>) <strong>compute_beat_layout</strong>(music) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the vertical layout policy</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>music</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Harpnotes::Music::Document the document to transform don't be confused it
is just to make inject music in the scope of the returned procedure</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Proecdure, to compute the vertical distance of a particular beat</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


627
628
629
630
631</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 627</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compute_beat_layout'>compute_beat_layout</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span>
  <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_beat'>beat</span><span class='op'>|</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_beat'>beat</span> <span class='op'>-</span><span class='int'>1</span> <span class='rparen'>)</span> <span class='op'>*</span> <span class='const'>BEAT_SPACING</span> <span class='op'>+</span> <span class='const'>Y_OFFSET</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="duration_to_id-instance_method">
  
    - (<tt>Object</tt>) <strong>duration_to_id</strong>(duration)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert a duration to a symbol todo: move DURATION_TO_STYLE in here</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>duration</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Duration as multiples of min note see DURATION_TO_STYLE</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The generated drawing primitive</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


862
863
864</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 862</span>

<span class='kw'>def</span> <span class='id identifier rubyid_duration_to_id'>duration_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_duration'>duration</span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>d</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_duration'>duration</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout-instance_method">
  
    - (<tt><span class='object_link'><a href="../Drawing/Sheet.html" title="Harpnotes::Drawing::Sheet (class)">Harpnotes::Drawing::Sheet</a></span></tt>) <strong>layout</strong>(music, beat_layout = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>compute the layout of the Harnote sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>music</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Harpnotes::Music::Song the Sont to transform</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<h1>nil [Lambda] Policy procedure to compute the vertical layout</h1>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Drawing/Sheet.html" title="Harpnotes::Drawing::Sheet (class)">Harpnotes::Drawing::Sheet</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Sheet to be provided to the rendering engine</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 640</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout'>layout</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>


  <span class='comment'># first optimize the vertical arrangement of the notes
</span>  <span class='comment'># by analyzing the beat layout
</span>  <span class='id identifier rubyid_beat_layout'>beat_layout</span> <span class='op'>=</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span> <span class='op'>||</span> <span class='id identifier rubyid_compute_beat_layout'>compute_beat_layout</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_beat_compression_map'>beat_compression_map</span> <span class='op'>=</span> <span class='id identifier rubyid_compute_beat_compression'>compute_beat_compression</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_compressed_beat_layout'>compressed_beat_layout</span> <span class='op'>=</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_beat'>beat</span><span class='op'>|</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_beat_compression_map'>beat_compression_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_beat'>beat</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># sheet_elements derived from the voices
</span>  <span class='id identifier rubyid_sheet_elements'>sheet_elements</span>  <span class='op'>=</span> <span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_voices'>voices</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
    <span class='id identifier rubyid_layout_voice'>layout_voice</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_compressed_beat_layout'>compressed_beat_layout</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_even?'>even?</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>

  <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_sheet_elements'>sheet_elements</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Ellipse</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_origin'>origin</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='rbracket'>]</span>

  <span class='comment'># configure which synclines are required from-voice to-voice
</span>  <span class='comment'># todo Maybe we provide required_synchlines as property of the Sheet
</span>  <span class='id identifier rubyid_required_synchline_table'>required_synchline_table</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>              <span class='comment'># 0 voices
</span>                              <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>              <span class='comment'># 1 voice
</span>                              <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span>          <span class='comment'># 2 voices
</span>                              <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span>          <span class='comment'># 3 voices
</span>                              <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='lbracket'>[</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rbracket'>]</span>     <span class='comment'># 4 voices
</span>                              <span class='rbracket'>]</span>
  <span class='id identifier rubyid_required_synchlines'>required_synchlines</span> <span class='op'>=</span> <span class='id identifier rubyid_required_synchline_table'>required_synchline_table</span><span class='lbracket'>[</span><span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_voices'>voices</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rbracket'>]</span>

  <span class='comment'># build synchlines
</span>  <span class='id identifier rubyid_synch_lines'>synch_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_required_synchlines'>required_synchlines</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_selector'>selector</span><span class='op'>|</span>
    <span class='id identifier rubyid_synch_points_to_show'>synch_points_to_show</span> <span class='op'>=</span> <span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_build_synch_points'>build_synch_points</span><span class='lparen'>(</span><span class='id identifier rubyid_selector'>selector</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_synch_points_to_show'>synch_points_to_show</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sp'>sp</span><span class='op'>|</span>
      <span class='const'>FlowLine</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_sp'>sp</span><span class='period'>.</span><span class='id identifier rubyid_notes'>notes</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_sp'>sp</span><span class='period'>.</span><span class='id identifier rubyid_notes'>notes</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:dashed</span><span class='comma'>,</span> <span class='id identifier rubyid_sp'>sp</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>


  <span class='comment'># now generate sheet_marks
</span>  <span class='id identifier rubyid_sheet_marks'>sheet_marks</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rightmark'>rightmark</span> <span class='op'>=</span> <span class='const'>Harpnotes</span><span class='op'>::</span><span class='const'>Music</span><span class='op'>::</span><span class='const'>Note</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>79</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_leftmark'>leftmark</span> <span class='op'>=</span> <span class='const'>Harpnotes</span><span class='op'>::</span><span class='const'>Music</span><span class='op'>::</span><span class='const'>Note</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>43</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span>
  <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='int'>3</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_rightmark'>rightmark</span><span class='period'>.</span><span class='id identifier rubyid_beat'>beat</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>16</span>
    <span class='id identifier rubyid_leftmark'>leftmark</span><span class='period'>.</span><span class='id identifier rubyid_beat'>beat</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>*</span> <span class='int'>8</span>
    <span class='id identifier rubyid_sheet_marks'>sheet_marks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_layout_note'>layout_note</span><span class='lparen'>(</span><span class='id identifier rubyid_rightmark'>rightmark</span><span class='comma'>,</span> <span class='id identifier rubyid_compute_beat_layout'>compute_beat_layout</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sheet_marks'>sheet_marks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_layout_note'>layout_note</span><span class='lparen'>(</span><span class='id identifier rubyid_leftmark'>leftmark</span><span class='comma'>,</span> <span class='id identifier rubyid_compute_beat_layout'>compute_beat_layout</span><span class='lparen'>(</span><span class='id identifier rubyid_music'>music</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>


  <span class='comment'># now generate legend
</span>
  <span class='id identifier rubyid_annotations'>annotations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_legend'>legend</span> <span class='op'>=</span> <span class='id identifier rubyid_music'>music</span><span class='period'>.</span><span class='id identifier rubyid_meta_data'>meta_data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='rbrace'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_annotations'>annotations</span> <span class='op'>&lt;&lt;</span> <span class='const'>Harpnotes</span><span class='op'>::</span><span class='const'>Drawing</span><span class='op'>::</span><span class='const'>Annotation</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>10</span><span class='comma'>,</span> <span class='int'>10</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_legend'>legend</span><span class='comma'>,</span> <span class='symbol'>:regular</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sheet_elements'>sheet_elements</span> <span class='op'>=</span> <span class='id identifier rubyid_synch_lines'>synch_lines</span> <span class='op'>+</span> <span class='id identifier rubyid_sheet_elements'>sheet_elements</span> <span class='op'>+</span> <span class='id identifier rubyid_sheet_marks'>sheet_marks</span> <span class='op'>+</span> <span class='id identifier rubyid_annotations'>annotations</span>

  <span class='const'>Harpnotes</span><span class='op'>::</span><span class='const'>Drawing</span><span class='op'>::</span><span class='const'>Sheet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_sheet_elements'>sheet_elements</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_accord-instance_method">
  
    - (<tt>Object</tt>) <strong>layout_accord</strong>(root, beat_layout)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Place a SynchPoint on the Sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>root</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Music/SynchPoint.html" title="Harpnotes::Music::SynchPoint (class)">SynchPoint</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The SynchPoint to be placed</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'>(<tt>lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>procedure to compute the y_offset of a given beat</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The generated drawing primitive</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


822
823
824
825
826
827
828
829</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 822</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_accord'>layout_accord</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_notes'>notes</span> <span class='op'>=</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_notes'>notes</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_pitch'>pitch</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_resnotes'>resnotes</span> <span class='op'>=</span> <span class='id identifier rubyid_notes'>notes</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_layout_note'>layout_note</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>&lt;&lt;</span> <span class='const'>FlowLine</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_resnotes'>resnotes</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_resnotes'>resnotes</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='comma'>,</span> <span class='symbol'>:dashed</span><span class='comma'>,</span> <span class='id identifier rubyid_root'>root</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_resnotes'>resnotes</span>
  <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_measure_start-instance_method">
  
    - (<tt>Object</tt>) <strong>layout_measure_start</strong>(root, beat_layout)  <span class="extras">(private)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


848
849
850
851
852
853
854</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 848</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_measure_start'>layout_measure_start</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_x_offset'>x_offset</span>     <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>PITCH_OFFSET</span> <span class='op'>+</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_pitch'>pitch</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='const'>X_SPACING</span> <span class='op'>+</span> <span class='const'>X_OFFSET</span>
  <span class='id identifier rubyid_y_offset'>y_offset</span>     <span class='op'>=</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_beat'>beat</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scale'>scale</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='id identifier rubyid_dotted'>dotted</span> <span class='op'>=</span> <span class='const'>DURATION_TO_STYLE</span><span class='lbracket'>[</span><span class='id identifier rubyid_duration_to_id'>duration_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_duration'>duration</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>         <span class='op'>=</span> <span class='const'>ELLIPSE_SIZE</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>*</span> <span class='id identifier rubyid_scale'>scale</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>Ellipse</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_x_offset'>x_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_y_offset'>y_offset</span> <span class='op'>-</span> <span class='id identifier rubyid_size'>size</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>-</span> <span class='float'>0.5</span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_size'>size</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='float'>0.1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_root'>root</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_note-instance_method">
  
    - (<tt>Object</tt>) <strong>layout_note</strong>(root, beat_layout)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Place a Note on the sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>root</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Music/Note.html" title="Harpnotes::Music::Note (class)">Note</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The note</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'>(<tt>lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>procedure to compute the y_offset of a given beat</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The generated drawing primitive</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


805
806
807
808
809
810
811
812
813
814</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 805</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_note'>layout_note</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='comment'>#               shift to left   pitch          space     stay away from border
</span>  <span class='id identifier rubyid_x_offset'>x_offset</span>     <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>PITCH_OFFSET</span> <span class='op'>+</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_pitch'>pitch</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='const'>X_SPACING</span> <span class='op'>+</span> <span class='const'>X_OFFSET</span>
  <span class='id identifier rubyid_y_offset'>y_offset</span>     <span class='op'>=</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_beat'>beat</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scale'>scale</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='id identifier rubyid_dotted'>dotted</span> <span class='op'>=</span> <span class='const'>DURATION_TO_STYLE</span><span class='lbracket'>[</span><span class='id identifier rubyid_duration_to_id'>duration_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_duration'>duration</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>         <span class='op'>=</span> <span class='const'>ELLIPSE_SIZE</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>*</span> <span class='id identifier rubyid_scale'>scale</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>Ellipse</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_x_offset'>x_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_y_offset'>y_offset</span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='id identifier rubyid_dotted'>dotted</span><span class='comma'>,</span> <span class='id identifier rubyid_root'>root</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_pause-instance_method">
  
    - (<tt>Object</tt>) <strong>layout_pause</strong>(root, beat_layout)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Draw a Pause on the Sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>root</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Music/Pause.html" title="Harpnotes::Music::Pause (class)">Pause</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Pause to be drawn</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'>(<tt>lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>procedure to compute the y_offset of a given beat</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The generated drawing primitive</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


837
838
839
840
841
842
843
844
845</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 837</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_pause'>layout_pause</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_x_offset'>x_offset</span>     <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>PITCH_OFFSET</span> <span class='op'>+</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_pitch'>pitch</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='const'>X_SPACING</span> <span class='op'>+</span> <span class='const'>X_OFFSET</span>
  <span class='id identifier rubyid_y_offset'>y_offset</span>     <span class='op'>=</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_beat'>beat</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scale'>scale</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='id identifier rubyid_dotted'>dotted</span> <span class='op'>=</span> <span class='const'>DURATION_TO_STYLE</span><span class='lbracket'>[</span><span class='id identifier rubyid_duration_to_id'>duration_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_duration'>duration</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_size'>size</span>         <span class='op'>=</span> <span class='const'>ELLIPSE_SIZE</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>*</span> <span class='id identifier rubyid_scale'>scale</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>Harpnotes</span><span class='op'>::</span><span class='const'>Drawing</span><span class='op'>::</span><span class='const'>Rest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span> <span class='id identifier rubyid_x_offset'>x_offset</span><span class='comma'>,</span> <span class='id identifier rubyid_y_offset'>y_offset</span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_fill'>fill</span><span class='comma'>,</span> <span class='id identifier rubyid_dotted'>dotted</span><span class='comma'>,</span> <span class='id identifier rubyid_root'>root</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_playables-instance_method">
  
    - (<tt>type</tt>) <strong>layout_playables</strong>(root, beat_layout)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>layout the one Playable on the sheet</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>root</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Music/Playable.html" title="Harpnotes::Music::Playable (class)">Playable</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the entity to be drawn on the sheet</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'>(<tt>lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>procedure to compute the y_offset of a given beat</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>type</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><dl class="rdoc-list"><dt>description</dt>
<dd></dd></dl>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


784
785
786
787
788
789
790
791
792
793
794
795
796</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 784</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_playables'>layout_playables</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Note</span>
    <span class='id identifier rubyid_layout_note'>layout_note</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>MeasureStart</span>
    <span class='id identifier rubyid_layout_measure_start'>layout_measure_start</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>SynchPoint</span>
    <span class='id identifier rubyid_layout_accord'>layout_accord</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_root'>root</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Pause</span>
    <span class='id identifier rubyid_layout_pause'>layout_pause</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='backtick'>`</span><span class='tstring_content'>console.log(&quot;Missing Music -&gt; Sheet transform: &quot; + root)</span><span class='tstring_end'>`</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout_voice-instance_method">
  
    - (<tt>Array of Element</tt>) <strong>layout_voice</strong>(voice, beat_layout, show_flowline = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>compute the layout of a particular voice. It places flowlines playables and
jumplines. The vertical arrangement is goverend by the beat_layout, which
actually maps the beat in the timing domain to the beat in the sheet.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>voice</span>
      
      
        <span class='type'>(<tt>Array of <span class='object_link'><a href="../Music/MusicEntity.html" title="Harpnotes::Music::MusicEntity (class)">MusicEntity</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Voice to be layouted</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beat_layout</span>
      
      
        <span class='type'>(<tt>lambda</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>procedure to compute the y_offset of a given beat</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array of Element</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the list of elements to be drawn. It consists of flowlines, playbles and
jumplines. note that these shall be rendered in the given order.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'harpnotes.rb', line 709</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout_voice'>layout_voice</span><span class='lparen'>(</span><span class='id identifier rubyid_voice'>voice</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='comma'>,</span> <span class='id identifier rubyid_show_flowline'>show_flowline</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>

  <span class='comment'># draw the playables
</span>  <span class='id identifier rubyid_res_playables'>res_playables</span> <span class='op'>=</span> <span class='id identifier rubyid_voice'>voice</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Playable</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_playable'>playable</span><span class='op'>|</span>
    <span class='id identifier rubyid_layout_playables'>layout_playables</span><span class='lparen'>(</span><span class='id identifier rubyid_playable'>playable</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>

  <span class='comment'># layout the measures
</span>  
  <span class='id identifier rubyid_res_measures'>res_measures</span> <span class='op'>=</span> <span class='id identifier rubyid_voice'>voice</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>MeasureStart</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_measure'>measure</span><span class='op'>|</span>
    <span class='id identifier rubyid_layout_playables'>layout_playables</span><span class='lparen'>(</span><span class='id identifier rubyid_measure'>measure</span><span class='comma'>,</span> <span class='id identifier rubyid_beat_layout'>beat_layout</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># this is a lookup-Table to navigate from the drawing primitive (ellipse) to the origin
</span>  <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_res_playables'>res_playables</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_origin'>origin</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_res_playables'>res_playables</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>FlowLine</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_origin'>origin</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='rbrace'>}</span>

  <span class='comment'># draw the flowlines
</span>  <span class='id identifier rubyid_previous_note'>previous_note</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_res_flow'>res_flow</span> <span class='op'>=</span> <span class='id identifier rubyid_voice'>voice</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Playable</span> <span class='kw'>or</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>SynchPoint</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_playable'>playable</span><span class='op'>|</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='const'>FlowLine</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_previous_note'>previous_note</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_playable'>playable</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_previous_note'>previous_note</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_previous_note'>previous_note</span> <span class='op'>=</span> <span class='id identifier rubyid_playable'>playable</span>
    <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>

  <span class='id identifier rubyid_res_flow'>res_flow</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_show_flowline'>show_flowline</span>

  <span class='comment'># draw the jumplines
</span>  <span class='id identifier rubyid_res_dacapo'>res_dacapo</span> <span class='op'>=</span> <span class='id identifier rubyid_voice'>voice</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Dacapo</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_dacapo'>dacapo</span><span class='op'>|</span>
    <span class='const'>JumpLine</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_dacapo'>dacapo</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_note_to_ellipse'>note_to_ellipse</span><span class='lbracket'>[</span><span class='id identifier rubyid_dacapo'>dacapo</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_dacapo'>dacapo</span><span class='period'>.</span><span class='id identifier rubyid_level'>level</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># return all drawing primitives
</span>  <span class='id identifier rubyid_res_flow'>res_flow</span> <span class='op'>+</span> <span class='id identifier rubyid_res_playables'>res_playables</span> <span class='op'>+</span> <span class='id identifier rubyid_res_dacapo'>res_dacapo</span> <span class='op'>+</span> <span class='id identifier rubyid_res_measures'>res_measures</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jun 12 22:24:56 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.9.3).
</div>

  </body>
</html>