# Rakefile
require 'opal'
require 'opal-jquery'

desc "Build our app to build.js"
task :build do
  env = Opal::Environment.new
  env.append_path "."

  File.open("build.js", "w+") do |out|
    out << env["application"].to_s
  end

  Dir.glob "../public/*.scss" do |f|
    cmd = "sass #{f} > #{File.dirname(f)}/#{File.basename(f, ".scss")}.css"
    puts sh cmd
  end
end

desc "Build the documentation"
task :doc do
	sh "yard doc . --verbose --backtrace --protected --private"
	sh "yard graph -f doc/diagram.dot -d --verbose --backtrace --full --protected --private"
end

desc "start the development server"
task :server do
  cd "../" do
    sh "bundle exec rackup"
  end
end


desc "Build a distribution for the server"
task :deploy => [:build] do

end
